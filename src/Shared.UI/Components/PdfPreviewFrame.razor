@using MudBlazor

<div style="border: 1px solid #e5e7eb; border-radius: 4px; height: 100%; min-height: 600px;">
    @if (Loading)
    {
        <div style="display: flex; align-items: center; justify-content: center; height: 100%; min-height: 600px;">
            <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
        </div>
    }
    else if (!string.IsNullOrWhiteSpace(Error))
    {
        <div style="padding: 20px;">
            <MudAlert Severity="Severity.Error">@Error</MudAlert>
        </div>
    }
    else if (PdfBytes == null || PdfBytes.Length == 0)
    {
        <div style="padding: 20px;">
            <MudAlert Severity="Severity.Info">Keine Vorschau verf?gbar.</MudAlert>
        </div>
    }
    else
    {
        <iframe src="@_pdfDataUrl" style="width: 100%; height: 100%; min-height: 600px; border: none;"></iframe>
    }
</div>

@code {
    [Parameter]
    public byte[]? PdfBytes { get; set; }

    [Parameter]
    public bool Loading { get; set; }

    [Parameter]
    public string? Error { get; set; }

    private string _pdfDataUrl = string.Empty;

    protected override void OnParametersSet()
    {
        if (PdfBytes != null && PdfBytes.Length > 0)
        {
            var base64 = Convert.ToBase64String(PdfBytes);
            _pdfDataUrl = $"data:application/pdf;base64,{base64}";
        }
        else
        {
            _pdfDataUrl = string.Empty;
        }
    }
}
